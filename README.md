# el-training

## このカリキュラムについて

この文書は、必須とされる PHP Laravel とその周辺技術の基礎を習得するための新入社員教育用カリキュラムです。
新入社員の能力によらず、必ず一通りのステップを実施していただきます。
研修期間は特に定めておりません。
すべてのステップを完了した時点で研修修了となります。

本カリキュラムでは、以下の登場人物を想定しています。

-   新入社員 : 本カリキュラムの受講者です。
-   サポーター : 新入社員の教育・指導・助言を行います。また、新入社員と相談して仕様を一緒に決めたりする役割も担います。

指導について、サポーターがどの程度関与するかどうかはサポーターの裁量に一任します。また、研修期間については、新入社員のスキルレベルや社内の案件状況を考慮して、サポーターの方であらかじめ目安を設定する予定です。

## 概要

### システムの要件

本カリキュラムでは、課題としてタスク管理システムを開発していただきます。
タスク管理システムでは、以下のことを行いたいと考えています。

-   自分のタスクを簡単に登録したい
-   タスクに終了期限を設定できるようにしたい
-   タスクに優先順位をつけたい
-   ステータス（未着手・着手・完了）を管理したい
-   ステータスでタスクを絞り込みたい
-   タスク名・タスクの説明文でタスクを検索したい
-   タスクを一覧したい。一覧画面で（優先順位、終了期限などを元にして）ソートしたい
-   タスクにラベルなどをつけて分類したい
-   ユーザ登録し、自分が登録したタスクだけを見られるようにしたい

また、上記の要件を満たすにあたって、次のような管理機能がほしいと考えています。

-   ユーザの管理機能

### サポートブラウザ

-   サポートブラウザは macOS/Chrome 各最新版を想定しています

### アプリケーション（サーバ）の構成について

以下の言語・ミドルウェアを使って構築していただきたいです（いずれも最新の安定バージョン）。

-   PHP Laravel FrameWrok
-   PostgreSQL

サーバについては以下を利用していただきたいです。

-   Heroku

※ 性能要求・セキュリティ要求は特に定めませんが、一般的な品質で作ってください。
あまりにサイトのレスポンスが悪い場合は改善をしていただきます

## 本カリキュラムの最終目標

本カリキュラムの終了時点で、以下の項目を習得することを想定しています。

-   Laravel を利用した基本的な Web アプリケーションの実装ができるようになること
-   Laravel アプリケーションで一般的な環境を使ってアプリケーションを公開できること
-   公開された Laravel アプリケーションに対して、機能の追加やデータのメンテナンスができること
-   GitHub で PR をしてマージする一連の流れを習得すること。また、それに必要な Git のコマンドを習得すること
    -   適切な粒度でコミットができること
    -   適切に PR の説明文が書けること
    -   レビューに対する対応と修正が一通りできること
-   不明な点を適切なタイミングでチームメンバーや関係者に（今回はサポーターになります）口頭やチャットなどで質問ができること

## 推奨図書

研修カリキュラムを進めるにあたって、以下の書籍を推奨図書としてオススメします。

-   [現場で使える Laravel 速習実践ガイド]
    現場で使える Laravel 速習実践ガイドでは、研修カリキュラムと同様にタスク管理システムを題材としています。
    そのため、本研修を進める上で参考になる点が多数あるかと思います。

また、本研修ではカバーしきれなかった内容や、チーム開発の進め方についても解説されています。ぜひ参考にしてみてください。

## 開発に役立つトピック集

特定の課題ステップには含められませんでしたが、活用してほしいトピックについて topics.md にまとめています。カリキュラムを実施する上で、必要に応じて参照して活用してください。

## 課題ステップ

### ステップ 1: Laravel の開発環境を構築しよう

#### 1-1: PHP のインストール

-   パッケージ管理システムを利用して最新バージョンの homebrew をインストールしてください
-   `brew -v` コマンドで Homebrew のバージョンが表示されることを確認してください
-   `brew install php` コマンドで PHP をインストールしてください。
-   `php -v` コマンドで PHP のバージョンが表示されることを確認してください

#### 1-2: Composer のインストール

-   php コマンドで Composer をインストールしましょう
    ※ 下記のリンクを参照してください。
    https://getcomposer.org/download/
-   `composer -v` コマンドで Composer のバージョンが表示されることを確認してください

#### 1-3: Docker のインストール

-   対処の OS により Docker のホームページに Docker をインストールしてください。

#### 1-4: データベース（PostgreSQL）のインストール

-   手元の OS で PostgreSQL をインストールしましょう
    -   macOS の場合は `brew` などでインストールしてください

### ステップ 2: GitHub にリポジトリを作成しよう

-   手元に Git をインストールしましょう
    -   macOS の場合は `brew` などでインストールしてください
    -   `gitconfig` でユーザ名、メールアドレスを登録しましょう
-   アプリ名（=リポジトリ名）を考えましょう
-   リポジトリを作成しましょう
    -   アカウントがない場合は取得しましょう
    -   その上で空のリポジトリを作成しましょう

### ステップ 3: Laravel Sail プロジェクトを作成しよう

-   まず Git で新たにトピックブランチを切りましょう
    -   以降、トピックブランチ上で作業をしてコミットをしていきます
-   `composer create-project laravel/laravel projectname` コマンドでアプリケーションに最低限必要なディレクトリやファイルを作成しましょう
-   `composer require laravel/sail --dev`と `php artisan sail:install`をインストールしてください
    　　※　インストール中に pgsql (PostgreSQL Database)を選択してください
-   `alias sail='[ -f sail ] && sh sail || sh vendor/bin/sail'`を設定した場合、`sail up`コマンドで起動ができる
-   GitHub 上で PR を作成してレビューしてもらいましょう
    -   必要に応じて WIP（Work In Progress) で PR を出すようにしましょう。詳しくはトピック集を参照してください
    -   コメントが付いたらその対応を行ってください。LGTM（Looks Good To Me）が 2 つ付いたら main ブランチにマージしましょう

### ステップ 4: 作りたいアプリケーションのイメージを考えよう

-   設計を進める前に、どのようなアプリになるか完成イメージを（サポーターと一緒に）考えてみましょう。ペーパープロトタイピングによる画面設計などがおすすめです
    -   また、このアプリがどのような形で利用されるか（インターネットに公開するのか、社内向けか、etc…）についても（サポーターと一緒に）考えてみましょう
-   システムの要件を読んで、必要なデータ構造を考えてみましょう
    -   どのようなテーブルが必要そうか・各テーブル名・カラム名・データ型・制約など、スキーマを作る際に必要な情報を考えてみましょう
-   データ構造を考えたら、それを ER 図として書き起こしてみましょう
    -   完成したら撮影し、サポーターにレビューしてもらいましょう
    -   サポーターにレビューしてもらった結果、問題なさそうであれば、リポジトリに ER 図を入れておきましょう
    -   `README.md` にテーブルスキーマを記載して PR を作成し、レビューしてもらいましょう

※ 現時点で正解の ER 図を作成する必要はまだありません。現時点での想定として作ってみましょう（今後のステップで間違いと思ったら改修していくイメージです）

### ステップ 5: データベースの接続設定（周辺設定）をしよう

-   DBeaver をインストールしましょう
-   （PostgreSQL のデータベースドライバ）をインストールしましょう
-   `sail artisan migrate` コマンドでデータベースの作成をしましょう
-   DBeaver でデータベースへの接続確認をしましょう
-   GitHub 上で PR を作成してレビューしてもらいましょう

### ステップ 6: ログイン機能を作成しよう

-   Laravel breeze 機能を利用して、ログイン機能を開発
-   `php artisan breeze:install`コマンドでログイン機能を作成しましょう
-   `php artisan migrate` コマンドで PostgreSQL Database を作成してください
    　※　 Laravel breeze 詳細設定は下記のリンクを参照してください
    https://laravel.com/docs/9.x/sail

【Option】

-   ログインのページフォマット変更したい場合、

*   Boostrap 4 を使ってください
*   ネットで無料 Template を使ってください

### ステップ 7: ユーザープロフィール機能を作成しよう

-   `php artisan make:controller UserController`コマンドで UserController を作成しましょう
-   resources/views のフォルダにユーザープロフィールのページを作成してください
    　※ Laravel Controller の詳細は下記のリンクを参照してください
    https://laravel.com/docs/9.x/controllers

### ステップ 8: ユーザープロフィール編集機能を作成しよう

-   UserDatabse に'profile_image'を追加してください
-   `php artisan migrate:refresh` と `php artisan migrate`コマンドでデータベースを更新しましょう
-   resources/views のフォルダにユーザープロフィールのページに Edit ボタンを作成してください
-   UserController にデーター処理・データーをデータベースに保存してください
    　※ Laravel Controller の詳細は下記のリンクを参照してください
    https://laravel.com/docs/9.x/controllers

### ステップ 9: ユーザーパスワード編集機能を作成しよう

-   resources/views のフォルダにユーザーパスワード編集のページを作成してください
-   UserController にデーター処理（入力した旧パスワードと現パスワードを比較など）
    　データーをデータベースに保存してください
    　※ Laravel Authentication の詳細は下記のリンクを参照してください
    https://laravel.com/docs/9.x/authentication

### ステップ 10: ログアウト機能を作成しよう　【Option】

-   もし Breeze のテンプレート使用の場合、このステップが必要ない
-   また Http Post 使用の場合もこのステップが必要ない
-   もし Http Get 使用の場合、UserController のファイルに
    　 destroy メソッドを作成してください。

### ステップ 10: タスクを閲覧・登録・更新・削除できるようにしよう

タスクの一覧画面、詳細画面、作成画面、編集画面、削除機能を作成しましょう
これらの機能を一度に作成すると、PR が巨大になりがちです。
そのため、ステップ 8 では PR を複数に分けて進めていきます。
今後のステップでも、PR が大きくなりそうな場合は 2 つ以上に分けて PR を出せないか検討しましょう

### ステップ 10-1: タスク登録を作成しよう

-   Task Controller と migration を作ってください
-   Models の Task と User にイントロダクション使用を連携してください
-   resources/view のフォルダにタスク登録ページを作ってください
    　※イントロダクション使用詳細は下記のリンクを詳細してください
    https://readouble.com/laravel/9.x/ja/eloquent-relationships.html#one-to-one

### ステップ 10-2: タスク覧表を作成しよう

-   確認しやすい為に、Database:Seeding を使用してください
    ※ タスクとユーザの Factory ファイルを作成してください。
    　下記のリンクを参照してください
    　https://readouble.com/laravel/8.x/ja/seeding.html
-   View フォルダーに Task 一覧表の Blade を作成しましょう
-   Task Controller と migration を作ってください
-   Models の Task と User にイントロダクション使用を連携してください
-   resources/view のフォルダにタスク登録ページを作ってください
    　※イントロダクション使用詳細は下記のリンクを詳細してください
    https://readouble.com/laravel/9.x/ja/eloquent-relationships.html#one-to-one
    
### ステップ 10-3: タスク編集機能・削除機能を作成しよう

-   TaskControllerにタスク編集の処理ロジックを作成してください
-   Viewフォルダに編集ページ作成してください
    ※タスク登録のページと同じいですので、そのままのフォマットを使用してください
-   編集を失敗したの場合、編集ページに戻ってください
　　 合格したの場合、タスク一覧に移行してください
    ※　タスク編集・削除機あ能は最初にユーザidをチェックしてください 
### ステップ 11: 検索・絞り込み機能できるようにしよう
-   一覧画面でタイトルとステータスで検索ができるようにしましょう
    -  GetRequestを使用してください
-   絞り込んだ際、ログを見て発行される SQL の変化を確認してみましょう
    -  LogのファイルにSQL コメントを確認してください

### ステップ 22: ユーザの管理画面を実装しよう

-   画面上に管理メニューを追加しましょう
-   管理画面にはかならず `/admin` という URL を先頭につけるようにしましょう
    -   `routes.rb` に追加する前に、あらかじめ URL やルーティング名（ `*_path` となる名前）を想定して設計してみましょう
-   ユーザ一覧・作成・更新・削除を実装しましょう
-   ユーザを削除したら、そのユーザが抱えているタスクを削除するようにしてみましょう
-   ユーザの一覧画面で、ユーザが持っているタスクの数を表示するようにしてみましょう
    -   N+1 問題を回避するための仕組みを取り入れましょう
-   ユーザが作成したタスクの一覧が見られるようにしてみましょう

### ステップ 23: ユーザにロールを追加しよう

-   ユーザに管理ユーザと一般ユーザを区別するようにしてみましょう
-   管理ユーザだけがユーザ管理画面にアクセスできるようにしてみましょう
    -   一般ユーザが管理画面にアクセスした場合、専用の例外を出してみましょう
    -   例外を補足して、適切にエラーページを表示しましょう（ステップ 25 で実施しても構いません）
-   ユーザ管理画面でロールを選択できるようにしましょう
-   管理ユーザが 1 人もいなくならないように削除の制御をしましょう
    -   モデルのコールバックを利用してみましょう
-   ※ Gem の使用・不使用は自由です


### ステップ 25: エラーページを適切に設定しよう

-   Rails が用意しているデフォルトのエラーページを自分が作った画面にしてみましょう
-   状況に応じて、適切にエラーページを設定しましょう
    -   ステータスコードの 404 ページと 500 ページの 2 種類の設定は少なくとも必須とします

## あとがき

お疲れさまでした。
あなたは教育カリキュラムを一通り完遂しました!!

このカリキュラムでは触れきれませんでしたが、今後は以下のトピックなどが必要になると思うので、学習を進めていくとよいと思います（案件を通じて学ぶことも多いと思います）。

-   Web アプリケーションの基本的な理解を深める
    -   HTTP と HTTPS に関する理解
-   Rails のもう少し進んだ使い方を習得する
    -   STI
    -   ロギング
    -   明示的なトランザクション
    -   非同期処理
    -   アセットパイプライン（どちらかというとリリース系のトピック）
-   JavaScript や CSS などのフロントエンドに関するより高度な理解
-   データベースに対する理解を深める
    -   SQL
    -   よりパフォーマンスを重視したクエリの構築
    -   インデックスの理解をより深める
-   サーバ環境に関するより多くの理解
    -   Linux OS
    -   Web サーバ（Nginx）の設定
    -   アプリケーションサーバ（Unicorn）の設定
    -   PostgreSQL に関する設定への理解
-   リリースに関するツールの理解
    -   Capistrano
    -   Ansible

ーーーーーー質問ーーーーーー
ー　 main -> userpage ブランチ -> logout ブランチ -> addtask ブランチ
ーーーーーー code+α ーーーーーーーーー GitPull+α------ GitPull+α 　
git pull と　 rebase 違う
https://kray.jp/blog/git-pull-rebase/

---

Feature -> controller
Unit---> model
